# Спринт 2 - Практическая работа pymongo-api

## Схема
[Ссылка](https://viewer.diagrams.net/?tags=%7B%7D&lightbox=1&highlight=0000ff&edit=_blank&layers=1&nav=1&title=task1.drawio#R%3Cmxfile%3E%3Cdiagram%20name%3D%22Page-1%22%20id%3D%22-H_mtQnk-PTXWXPvYvuk%22%3E7V3dc6M4Ev9rXLX34CkkgYDHZJLMXt3u3dTN7u3O0xWxScyubXyYfO1ff8IgDGrZ4BgkgTMPGYMB2%2F3561Z3a0I%2Br16%2FJMFm8XM8D5cTbM1fJ%2BRmgrFPLZ%2F9l515y8%2FYlmfnZx6TaJ6fQ%2FsT36K%2FwuKkVZx9iubhtnZhGsfLNNrUT87i9TqcpbVzQZLEL%2FXLHuJl%2FVM3wWMITnybBUt49rdoni6Ks4j6%2Bzd%2BDKPHRfHRHnbzN1YBv7j4JdtFMI9fKqfI7YR8TuI4zV%2BtXj%2BHy4x6nC75fXcH3i2%2FWBKu0zY3XC%2BX%2F97cuqvrfzw%2B%2Fcd5eELf19GUevljnoPlU%2FGLi2%2BbvnESJPHTeh5mT7Em5PplEaXht00wy959YVxn5xbpasmOEHv5EC2Xn%2BNlnLDjdbxmF13Pg%2B1idzsqDr4GaRom6%2BxM9lHsD7mGv6b4gc9hkoavlVPFr%2FsSxqswTd7YJcW7NikoXcja1EGFrL3sOYdpcdGiwjTsFCeDQloey4fvCcpeFDQ9hb7ueOiLHK30%2FesKk5%2FjX37d%2FnJn%2F9dHqfcc%2FTrFgLw%2Fx%2BvH%2BOYaUJmp3yZ7OXtbRozcCWmm9X3OmJ%2FuyxPB7M%2FHHbv%2B9ZSyx4TF%2BW1utpDTDaGnjitQ2uVUrVBaRmivLzoTQOfN2yqj9DTYREckGjVTuQuCuYBgDiQYwhKK0b4oZgOqhHPmWYrDOEkX8WO8Dpa3%2B7PXdUuwv%2BanON4U1PojTNO3wk0GT2lcp2X4GqW%2FV15%2Fzx71ySmObl6LJ%2B8O3vjBmv3c36sHlbuyw%2F1tu6PafV%2FDJGL0CpPi5EFmbuOnZBY2S1gaJI9h2qzxGTGPikYSLoM0eq678c7tO9bD5pJley59r753gGXbNIn%2FDLn7mGBi7f6JPqQVE6XkQJCJcrJ1zsXdrVdJErxVLtjE0TrdVp78NTtRsRu2L9gNbkH3MpE%2Fcy8h5Zd7v9Bw%2BzYup0WxQEtC1DktKZ09Hbr5fuXBLZXHNcsCGo4MQFCgEhnIKUZ0yGXvtt8emO2nnmj7fSGAbrwDeQ13AP%2BCVPgXe5T%2BxRWpr92%2F8BzVUByM21JDbbMcjDNKc9mWGd2by7O4AfNZjNRZ%2FGeep7cdqtnT%2Bzok91BwuA8Hu47nz5JvZJR4IxibMR%2BZzBHgJBPLtE74YBk9ZknXGaNVRsDrTHijWbC8Kt5YRfN5zuOQOcfgfveojMoFVmHPda4nzk32LMZW7kCBNSryvpJUcC9%2BFtvt%2FCzpzc%2FCGGPHFHw5TAHBtXamYMiUWbx%2BiB4zjoTJswkuwRFXLPS7BDy0pITf0o4Ts1CjC42DUt97Wi59y8ibXmXL1ZmpWgbbbTTjp%2B%2BipUI2umb5Y%2F69DU0vEdHAlAtR2gyMowV0dhQUkbZJJOIZJaYU4kOjrXprOjudW%2FV3JetsJOiZQ49n3vj7h27oJ%2FFGYObNkOgYGCrq6kZCBJYe5QDyW%2FKsnV6uZRy9OOC%2F3NAUAzhvwQIkpUEQ1bL8%2F367b7ddoLeJUf6Vf%2B9xLWlAefbbBfW9rWjYsM5rBHRGYnUYcdvZjf7oPMolOiJm4PXT2TngM6fJ5bhNRJ06W7AP2eKqdJs2PcgWmLYZK1sINo0tDrT%2BF5Znd8AaonaEqSWPeZCUjQjTaZ1ZKKTfEIRJtRRlqaAzNYrOziiRD7QbupG8A5HPCOhsixGTdoTpQCgzAjpTMd%2Bqn86w8CjHJpeE5G3bOMgIk7icLZeDGqllGlu4al5k5VnrxS2eVRza4hYWK7SULG5RLXW4hshU%2B8S5WWUwfEyBGUxr6k%2FsqIqAtq097b6K4F0GAOgzdwyHDIArrm4LN%2FTUtmjB2G0RBkvm4bA1W4SzP6Wy9lNwHy77c%2FtQTI4qAvDq5eiQ4lMm1ekc0qpC6xN2PNHj54enycmer%2FyS%2BOFhyyRW1PoOmOdqQQRdKbQ3LIV2bTF88nwV%2Bglj%2FsHoJ5fPTvTT9ZEnMOA8%2FeRfCNWfing2S4H%2BwhXwJJxHW8BS1ZUyoNJKfwmkC9cxjpDJ7KE7YsaLSOqQFM80ciEMGCx5xdIAA8iLkKvDVXeC2UHX5N0dYf%2FOcv5u604yHkdr9v5EgPMN0bw4VktFLI%2F0NNW%2BN5ivydgfT6sN%2F55BMpNJHbJc4t8qkjrLkCyS4IfFaYDC5R45dnlfUjew5qfWQuB1bnnO89BwscSorhnB6UrWShUDRi1yedxz%2Bu6Nxfh4jvhyqWwWX7OavlwtSUsFdPaxGa5CsP2kId3oeEev78dZ8M80sJdGMF9YMgZVrf3yYHLAoFYabBy5MCDXpXXSCCJsezDsVVrm6A2s%2FM5ru8bsmVXm6I2y%2FA6IswURpdrJk6OsvkPCNDsHtbMa%2FZF5lMV3Yq%2BufjIfqL27rC4aYcnX8SFXlNZ4eQdK7y6ricY2jStwYMml9dA4hmFL7rWGgi15lqA5nWBWk7Y%2FsCEo7elsVk0f%2F97jQj3AbOjG8P4oe%2BFt1zBw6Y8yIqXENDIf6IS%2FrP4Zahha9A80wl9W%2Bww2jStGFeAo7nRov2hoyGi4ExeziHX0%2Bn4Ws3wtC8ymSFTrXLlZrer%2BcHtn%2BqgmcFuz0YyCKFHRaUMdnjj3nCopxLNglDGYmn2uIJ3U7BPk1mv2CwBkbksNsrQklvpXdMlWjCYrutgN5xQVmT0rLoTug1HcUnLP11zrk%2BXZuEvF5SZB6OARHtCnWpvaaiPucqu9bhLxrIY2iOSa1auArLY5ZVOaFbBQndXUrHC0t6GvsnHdm%2Bxi07sVTpA7Q9oVsFBLYje0K1jHLu9L7nQHgKfJnQrx6b7R4X3SI0C%2Bpo04bevo9X1BRAyAhEltGNgyDk7oTpNh0%2BDE0HofxW7wJjhxFH30pJYIluhMGAuZSWBcvXZ2f8nur7c7j3Z%2Fq9dYu9e0cs3dBNNltjozj57Zy8d0x3carDK1Xd9vs%2F%2F4w%2FIPKR%2BG6x%2B1e3zxMPb7as8zN6DkmttFQEl9261b60kXASX35goiSGxWWGQkYB1afy1tQqhqQiHdS5OnSZYKATEEktLjELOxX1sRJDW7M9ixjYOksA1xwcxlNIuTTe7ctk9L7XQTguly%2FqdGumEdhqp%2FRM5HQA0GkYvjRaZK7AyGapNBW%2F9uB3Bvd39zQEx2f90K9r7hgHh3BpeQm%2F2160C9ipitU%2BC1wUCa5ww6ANLY8etA%2BtwxhXxlndaeiuv394irkZYuUYiIldgPnj3SXUYh%2BpaGwTJiak64vq%2BYXssSgR7J4NNdDCu8a5CL45f3JRZaxlzpMhiGyIW4216DYIiBkyKDARf5r77%2BnZ34EqThb8EbkBvdU0b2gFIfqOeuXkR1qALRriuvbyqoy6tgstsKMruqADj2ggPE%2FWF5l1d5Jq2cuStwJBPsjEe7%2F%2B%2BjNeDgOfXzMn7X7UQHLBej3z2M1tU6iXCLUarhes40NH6ZyKd3CuFZZZAnewwp47Tfip%2BIAWXD1yj9vXhC9nqXeMqLY9nRPvOUHXSQeGpvcDktGg1uhX2OhH383JmwXNyECglSkf%2F04qYjBlkc91TuPM0flFMGPKgz20wkweNhc2z4gFlHwM%2Flr9M4YZZA5zdcAhNkIIG1ZL%2BMHeGLiNPWpvI559qzZlj0xUV3yuGlbDFQFu7oCcgSLTmRAU3yPUH4qCHCB0Mi3CB8Pgi6sArhkwwe5KCeQfIcqstregxJt3Lt6SLdSiy%2B%2BVNH6VYFGVWiJW%2BmRJm73wvmTEwAO%2FBNWnpFjrgNHXJgH7bihAPRUkjTe4dVKZstpNg3TIq1FKAoITUPB3R7f0fw5UX%2F9EHfLw7YrV%2FfF%2ByE0%2BcMGc8MDRmPxjTaMVhyas6AZuSJS3b6CWbDFNCFjWhG4rawvOdFXzLYhtQ32%2FbzxtRm22%2BbNUqv%2FObjmooFZLrcQE%2FXWKyS8SMjNBFX2yWb8ikm9CjnvCHbN47QBya9Xda0ZiIMFSuHausaKobsA7PeLmpeM7I94%2FhyYLr5BTGFikZMP9Qc2E5xZfKgRZqh80WGM0mtpctdDamxWaR2YFQ7Bgwkmg%2F9qJ7r2NgILaYEtINNrmEjI7Q4ackAQsM49fLmNyNqmYYeHRjWXt4EZ%2BRS4%2FgyqA2uO564e8KiF080Dm3Ry7aPXd%2FTopeje66DVqE6IZtu1oYpTLhM4pv2Sc5l%2Fa%2BO8oP3mQdR3W3UYB98fPSGvgwEXBUfzlBYriWXOs7Z0ZIIUaDtrfMlpmi7L9S%2F4gLN9au8FGZnBqS8vMLkY6Lz4bpu4yY6I9%2FAoksKA9fLHupMB9e9QsSKrsbuFdLQ79KXzdXdvWL%2BaOf20mdK%2B4o46mGKrab2FbHzWbijr%2FYVmL0eVvsK7bB9xXFduYM2GLLTYU2GV2IFuu97eacVEJvYaIMRAOMPqBIPZHhbDgFDIQxAiLrzoKbN6XZbh9imIERX1M7m%2FuYGTNmXfsLyrI9p3efCBl6K%2BDGtO6OG7l0HzJ%2FW3d6%2BmRKDiLs5TrF93L5hCzTd20piEMmwm2HFIB2O%2Fkcu9c8zHyrshZZ1Ah0z2NurvSlBh3s8hmgxakNJ0OFCpTcq6KCi9TQg6ODI2exJ7AiLyS9i6Sedloy%2BgrCr9SYipoRdYEgUUTKnx5WMcXz%2FOPYy9LkDwVB1mmfL%2BIkPAzUY4nD9%2BRjKLiPO8Edvt7cjPFuo246Isz6nuAnogHQsVoN0hj%2BBu710EFOko2Ea3Ol39CUdWhLJmqSDk1i3dIhdRM22A0RVimwHTP2aNaNdMmrIgDgJ1qB%2BDGmfdDakHcbGhECeq%2B2WduF4KWhXxzWl%2FQSz2zY1pWZKO6LA1XL5OXVQO5j8NsWe8Ki%2BR7V7Q5sf6pHWctP5dirnKbkHY%2FiHJGY2cWdNH5JgFb7ECSxS1u8UHf0ZMJ520ZSzLw8qVrGflL3Xuk7IM2zkmQcLcT7f%2FJMvrt8nfGE9eeLZJWkJQIlcbvRrgkfqbbFTx9OvCVqG%2BOnQBDpYTYCToqSaEA5YE2wJaFatCfKc8wg1oTVW9jpPYJ3JIr3tAUayiJrFIg8maVZBFthb2zB5NmAeNLbEHZANwKPe0IZuea0nShjnTQ%2Fkw%2BDa5%2BfdaxdkvyxeUlr6WH69yEM%2B4%2BhptbyapXE1W7Vbyvwab6M0irO8yn2cpvFKks5KY0EH4nzU0ed8pbHJ1pwSqDmCU6Y%2BVAzSk158T79%2B2ZDbX5%2BtzT9%2BvNl8QS%2FfFlMIfDjqWaAapen%2FnuLs9IqJY7Se7mh2xa6wNq874lj38et0G%2F0VrR%2FzN6L1IkyivDDXemBh8%2FQhWEXLt%2Fzdsvi3eOz3b%2BzkL1kqUnhjgtkPs66SKFjmL38Ml89hxr%2F8cBust1Nm%2BKKH%2FJM2wXzOvoP0CybzMNm%2FUU7jsWZ5kUR2Mnm8D36w8kcL%2F33ynL%2Fl12cp02mRJb3aUSlI0spbuVXN3insa%2Fbp5SCtaf3jftj1WmefUH2RfxItiVCWTAuItFIKnTHsQCW0wWOQJCv8QMcOexpk%2BYJCSQZp9uVopAolKZ7%2FUKgzFKobvcncj1tZgrHryzG1chvnE%2FvzjUGpiDlobN1E21nMpPRtgvmCS%2FGiq%2FWd3cWMJeVK20u20ta3XrdduzlLQUErlQfV0%2BPDcbpeupHqpwSbfOjnoPQTfSoUsACU17JrpUonf97kFk88e%2BJnrb2jUDrQN%2BZJNjInvkqtky2Xfmjdh9YxrcMj0TqmZUJwh2Rq56pUO%2F4FPvTuQ%2B9EvUOj0TuxJoNiid55KvVOspkUIKzC7d7Poy%2F17E91y4ZdmLXqb8N3OYUl%2FRWDpbBPTaSwxkIjIZPdmEGX%2FwDJcrT8Ql%2FOns7T5Ue%2FZn%2BdiecJpwuFE5rX3hZz5CTTMl24Zg66lFO%2FpZw6BzqdFMmpxg2C1NKZaukSmLoWULQCoBwqR506TsMtZ%2FcJHKVkL1sRd22tEIJ746g1V5JNiDrdi%2Fg8itnIQIrBzvPhbUZ8ZlQDBJlIShn76nqQcwVC7GF5AEdSii6%2F0NbpaSU7D5mxxVPnEm1BJNnXJk9H%2BDw6Svu2SGkbtbMd%2FVEa1pqPgdIuyI3op%2FThXW8vyH36ti8yRlJq1dcOWXLGHNj2dmjbEZ%2BrMeYxBtYEDG8%2F4vO44gA7ph9taizY7QRt8sGMzfkGLGeOGrTJmXoBdCZa6Qxj2jEgIInl0I3q%2BXYqI6M0BfGTdqxJxxmpOiATq5%2FSh3e9vSBUT6lx4FGym8EgtyM%2BV2PMY4zuLRO62jpW8SLjuSBJ2eKXR7QsflGjtrbVLVftU%2BrOmXJ1njHQvePA%2B7dP6dIItGbWuZUG7zMCUKMd2mAECFgBF27pyQjAFXBTdi5tPTK3LkNH1Oaw28%2BG63pC1XOBeozYTkDeoacl4dGbTmOzdZq4IJayUP8KKptdP0IFdY8Pv2YK6vpI2GSQnKeg%2FJuj%2BlMRX0tVoMAwFv7oahhWVwPNuhoqI5YG3oMAt2rzJEWyahtdXZiY%2BNASM7Skum%2BeU%2BnbsSu6cst1ZRQKApt0pD2pHTXpsMMkzsi%2B9zrsdy1%2BjueZd7%2F9Pw%3D%3D%3C%2Fdiagram%3E%3C%2Fmxfile%3E)

## Как запустить

Запускаем mongodb и приложение

```shell
docker compose up -d
```
Выполняем настройки для шардирования и репликации

```shell
./scripts/configurate.sh
```


Заполняем mongodb данными

```shell
./scripts/mongo-init.sh
```

## Как проверить
### Шард №1
```shell
docker exec -it shard1 mongosh --port 27021
> use somedb;
> db.helloDoc.countDocuments();
> exit();
```
### Шард №2
```shell
docker exec -it shard2 mongosh --port 27022
> use somedb;
> db.helloDoc.countDocuments();
> exit();
```
### Если вы запускаете проект на локальной машине

Откройте в браузере http://localhost:8080

### Если вы запускаете проект на предоставленной виртуальной машине

Узнать белый ip виртуальной машины

```shell
curl --silent http://ifconfig.me
```

Откройте в браузере http://<ip виртуальной машины>:8080

## Доступные эндпоинты

Список доступных эндпоинтов, swagger http://<ip виртуальной машины>:8080/docs